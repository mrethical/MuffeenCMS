{"version":3,"sources":["resources.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"resources.js","sourcesContent":["\nfunction refreshTable(html) {\n    $('div#table-container').empty();\n    $('div#table-container').append(html);\n}\n\nfunction reloadTable() {\n    var success = function (result) {\n        refreshTable(result);\n        generatePagination();\n    }\n    callback('GET', 'admin/resources', 'html', {output: 'table'}, success);\n}\n\nfunction generatePagination() {\n    var count = $('input#total-record').val();\n    var limit = 10;\n    $('.pagination').pagination({\n        items: count,\n        itemsOnPage: limit,\n        onPageClick: function(pageNumber){\n            $('.pagination').pagination('disable');\n            var success = function(result){\n                refreshTable(result);\n                $('.pagination').pagination('enable');\n            }\n            callback('GET', 'admin/resources', 'html', {output: 'table', limit: limit, offset: (pageNumber - 1) * limit }, success);\n        }\n    });\n}\n\nfunction resetErrors() {\n    $('#modal-resource-form-title').removeClass('has-error');\n    $('#modal-resource-form-title .help-block').remove();\n}\n\nvar success = function(result){\n    if (result.success){\n        reloadTable();\n        $('#modal-resource').modal('hide');\n        $('#modal-resource-submit').prop('disabled', false);\n    }\n}\n\nvar error = function(response) {\n    if (response.status === 422) {\n        for (var key in response.responseJSON) {\n            var value = response.responseJSON[key];\n        }\n        $('#modal-resource-form-' + key).addClass('has-error');\n        $('#modal-resource-form-' + key).append('<p class=\"help-block\">' + value + '</p>');\n        $('#modal-resource-submit').prop('disabled', false);\n    }\n}\n\nvar prepForm = function() {\n    $('#modal-resource-submit').prop('disabled', true);\n    resetErrors();\n}\n\n$(function() {\n    $('#modal-resource-preview').on('show.bs.modal', function (event) {\n        var button = $(event.relatedTarget);\n        var name = button.data('name');\n        $(this).find('h4.modal-title').text(name);\n        $(this).find('img').attr('src', server_dir + 'uploads/' + name);\n    });\n    $('#modal-resource-preview').on('hide.bs.modal', function (event) {\n        $(this).find('h4.modal-title').text('');\n        $(this).find('img').attr('src', '');\n    });\n    $('#modal-resource').on('show.bs.modal', function (event) {\n        var button = $(event.relatedTarget);\n        var id = button.data('id');\n        $(this).find('img.res-info-src').prop(\"src\", server_dir + \"uploads/images-small/\" + button.data('name'));\n        $(this).find('p.res-info-name span').text(button.data('name'));\n        $(this).find('p.res-info-type span').text(button.data('type').toUpperCase() + \" File\");\n        $(this).find('p.res-info-size span').text(button.data('size'));\n        $(this).find('#res-id').val(button.data('id'));\n        $(this).find('#res-title').val(button.data('title'));\n        $(this).find('#res-alt').val(button.data('alt'));\n        $(\"#res-category\").val(button.data('category'));\n        $('#modal-resource-submit').click(function() {\n            prepForm();\n            var data = {\n                title: $(' #res-title').val(),\n                category_id: $('#res-category').val(),\n                alt: $('#res-alt').val(),\n                _token: $('#res-resource-token').val(),\n                _method: 'PATCH'\n            };\n            callback('POST', 'admin/resources/' + $('#res-id').val(), 'json', data, success, error);\n        });\n    })\n    $('#modal-resource-delete').on('show.bs.modal', function (event) {\n        var button = $(event.relatedTarget);\n        var id = button.data('id');\n        var name = button.data('name');\n        $('#modal-resource-delete-submit').click(function() {\n            $('#modal-resource-delete').modal('hide');\n            var data = {\n                _token: $('input#res-resource-token').val(),\n                _method: 'DELETE'\n            };\n            var success = function(result){\n                if (result.success){\n                    reloadTable();\n                }\n            }\n            callback('POST', 'admin/resources/' + id, 'json', data, success);\n        });\n    })\n\n    generatePagination();\n\n    $(document).on(\"keypress\", \"form\", function(event) {\n        return event.keyCode != 13;\n    });\n\n});"]}